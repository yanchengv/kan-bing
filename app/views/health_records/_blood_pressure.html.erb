
<!--血压 title end-->
<div class="box-title" style="padding-left:15px">
  <p class="pull-left"><strong><span class="font-18 font-yahei ">血压</span><span class="font-12">(mmHg)</span></strong> </p>
  <% if current_user.doctor_id.nil?%>
  <p class="pull-right" data-toggle="modal" data-target="#blood_pressure_modal" style="cursor:pointer;">
    <strong style="border-left:1px solid #d7d7d7;color:#ababab;font-size:30px;width:45px;display:inline-block;text-align:center;cursor:pointer;">+</strong></p>
   <%end%>
</div>
<!--血压 title end-->
<div id="blood_pressure_container" style="width:98%;height:400px;"></div>

<% if @is_record_table%>
<style>
    table tr td{
        padding:5px;
        text-align:center;
        color:#328ea5;
    }
</style>
<table style="width:95%;margin:40px auto 20px auto;">

  <tr style="border-bottom:2px solid #348fa4">
    <td style="border-right:1px dashed #a2a2a2"><strong>日期</strong></td>
    <td style="border-right:1px dashed #a2a2a2"><strong>收缩压(mmHg)</strong></td>
    <td style="border-right:2px solid #348fa4"><strong>舒张压(mmHg)</strong></td>
    <td style="border-right:1px dashed #a2a2a2"><strong>日期</strong></td>
    <td style="border-right:1px dashed #a2a2a2"><strong>收缩压(mmHg)</strong></td>
    <td ><strong>舒张压(mmHg)</strong></td>

  </tr>


      <tr style="border-bottom:1px dashed #a2a2a2">
        <td style="border-right:1px dashed #a2a2a2">2014/04/21</td>
        <td style="border-right:1px dashed #a2a2a2">92</td>
        <td style="border-right:2px solid #348fa4">120</td>
        <td style="border-right:1px dashed #a2a2a2">2014/04/21</td>
        <td style="border-right:1px dashed #a2a2a2">93</td>
        <td>112</td>

      </tr>

  <!--样式tr 不要放数据-->
  <tr style="">
    <td style="border-right:1px dashed #a2a2a2"></td>
    <td style="border-right:1px dashed #a2a2a2"></td>
    <td style="border-right:2px solid #348fa4"></td>
    <td style="border-right:1px dashed #a2a2a2"></td>
    <td style="border-right:1px dashed #a2a2a2"></td>
    <td></td>
  </tr>
  <!--样式tr end-->
</table>
<%end%>

<!-- Modal -->
<div class="modal fade" id="blood_pressure_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">添加记录</h4>
      </div>
      <form  action="blood_pressure/create" name="blood_pressure_form" method="post" id="blood_pressure_form">
      <div class="modal-body">
        <table style="width:100%;margin:0px auto;">
          <tr>
            <input type="hidden" name="patient_id" value="<%= current_user.patient_id%>">
            <td style="padding-right:5px;width:13%"><span class="font-yahei" style="color:#333;">收缩压</span></td>
            <td style="padding-right:5px;"><input type="text" name="systolic_pressure" id="systolic_pressure" class="blood_input_bg" style="margin-top:5px;"/></td>
            </tr>
            <tr>
            <td style="padding-right:5px;"><span class="font-yahei" style="color:#333;">舒张压</span></td>
            <td style="padding-right:5px;"><input type="text" name="diastolic_pressure" id="diastolic_pressure" class="blood_input_bg" style="margin-top:5px;"/></td>
            </tr>
            <tr>
            <td style="padding-right:5px;"><span class="font-yahei" style="color:#333;">时间</span></td>
            <td style="padding-right:5px;"><input type="text" name="measure_date" id="perssure_measure_date" class="blood_input_bg" style="margin-top:5px;" readonly="readonly"></td>
          </tr>
        </table>
      </div>
      <div class="modal-footer" style="padding:10px 20px 10px;">
        <input type="submit" value="保存" class="btn btn_g" style="margin-bottom:2px;" id="blood_pressure_submit">
      </div>
      </form>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<script type="text/javascript">
    //时间控件
    var nowDate = new Date();
    nowDate=nowDate.getFullYear()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getDate();
    $('#perssure_measure_date').datetimepicker({
        lang:'ch',
        value: nowDate,
        timepicker:false,
        format:'Y-m-d'
    });


    function pressureResponse(responseText, statusText, xhr, $form) {
        $('#blood_pressure_modal').modal('hide');
//        document.getElementById('blood-div').innerHTML = ""+responseText+"";
    }
    ;
    function pressureError(data){
        $('#blood_pressure_modal').modal('hide');
    }
    // ajax 血压 提交
    $('#blood_pressure_submit').click(function(){
        var options={
            url:'/blood_pressure/create',
            type:'post',
            data: $('#blood_pressure_form').serialize(),
            success: pressureResponse,
            error: pressureError

        };
        $.ajax(options);
        return false;
    });

    var systolic_pressure_data=<%= @systolic_pressure_data%>
    var diastolic_pressure_data=<%= @diastolic_pressure_data%>


</script>
<%= javascript_include_tag 'highcharts/blood_pressure'%>