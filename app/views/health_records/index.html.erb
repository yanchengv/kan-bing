<%#= javascript_include_tag 'jquery.fancybox-1.3.1.pack' %>
<%= javascript_include_tag 'timeline-min' %>
<%#= stylesheet_link_tag 'fancybox' %>
<%= stylesheet_link_tag 'timeline' %>
<%= stylesheet_link_tag 'timeline_data' %>
<div class="container bgcolor-white" style="margin-top:-20px;">

</div>
<div id="timeline">

</div>
<script>
    $(function(){
        <% if @type == 'patient'%>
        var datas = [];
        var i= 0,date = '',uuid = '',time = '';
        <% a = 1%>
        <% (@reports.length-1).times do %>
        date = "<%= @reports[a][1]%>";
        uuid = "<%= @reports[a][0]%>";
        time = "<%= @reports[a][2]%>";
        <% a = a+1 %>
        datas[i] = {
            "startDate":date,
            "headline":time+"超声报告",
            "text":" ",
            "asset":
            {
                "media":uuid,
                "credit":"",
                "caption":""
            }
        };
        i++;
        <% end %>
        <% @studyUID.each do |s|%>
        datas[i] = {
            "startDate":"<%= s[0]%>",
            "headline":"<%= s[1]%> CT",
            "text":" ",
            "asset":
            {
                "media":"<%= s[2] %>",
                "credit":"",
//                        "credit":"<div class='picture' style='width:600px;height: 380px'><img src='"+url+"' style='width: 540px;height:720px' /></div>",
                "caption":""
            }
        };
        i++;
        <% end %>
        var data_json = {
            "timeline":
            {
                "headline":"<%= @reports[0][0]%>系列电子病历",
                "type":"default",
                "startDate":"<%= @reports[0][1]%>",
                "text":"您出生于<%= @reports[0][2]%>，您有电子病历"+datas.length+"份！",
                "asset":
                {
                    "media":"",
                    "credit":"",
                    "caption":""
                },
                "date": datas
            }
        };
        var timeline = new VMM.Timeline();
        timeline.init(JSON.stringify(data_json));
        <% end %>
//        $('.slider-item .layout-text-media .media .media-container a').fancybox();
    });
</script>

