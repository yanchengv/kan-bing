<%= javascript_include_tag 'jquery.fancybox-1.3.1.pack' %>
<%= stylesheet_link_tag 'fancybox' %>
<style>
    .video_lists {


    }

    .title {
        color:#222;
        border-bottom: 1px solid #e5e5e5;
        background: -moz-linear-gradient(center top, #f5fafd, #ebf6f8) repeat scroll 0 0 transparent;
        background: -webkit-linear-gradient(#f5fafd, #ebf6f8) repeat scroll 0 0 transparent;
        filter: progid:DXImageTransform.Microsoft.Gradient(gradientType=0, startColorStr=#f5fafd, endColorStr=#ebf6f8); /* IE 6 7 8  */
        line-height: 40px;
        padding:0 10px;
        font-family:Arial,"Microsoft YaHei";
        font-size:16px;
    }

    .video_lists table tr {

        line-height: 30px;
    }
    .video_img{
        border-radius:2px;
        border:1px solid #A7A7A7;
        margin:5px 0;
    }
    .video_lists table tr:hover {

        cursor: pointer;
    }

    .video_lists table thead tr:hover {
        background: none;
    }
    .video_lists table tr td{
        text-align:center;
    }
    @media (min-width:1200px) {
        #ultrasound {
            float: left;
            margin-right: 10px;
        }

        .videos {
            float: left;
            width: 375px;
        }

    }
</style>
<div class="container" style="margin-top:-20px;padding:0px;">
  <div id="videoPlayer" style="width: 100%;height: 100%">

  </div>

  <div id="ultrasound" style="text-align:center;margin-top:10px;" class="index_box">
    <div class="title text-left">
      <strong>超声报告</strong>
    </div>
    <img width="780px"  style="margin:0 auto;" src="/dione/pdf_reports/show_picture?uuid=<%= @uuid %>">
  </div>
  <div style="margin:0 auto;" class="space3 videos">
    <div class="index_box" style="margin-top:10px;">
      <div class="title">
        <strong>超声视频</strong>
      </div>
      <div id="videos" class="video_lists ">
        <table style="width:100%;">
        </table>
      </div>
    </div>
    <div class="index_box" style="margin-top:10px;">
      <div class="title">
        <strong>超声图片</strong>
      </div>
      <div id="pictures" class="video_lists">
        <table style="width:100%;">

        </table>
      </div>
    </div>
  </div>
</div>

<script>
    $(function(){
        var cWidth = $('.container').width();
        var iWidth = (cWidth-650)/3;
        $.ajax({
            url: '/dione/pdf_reports/download_emr_img_video?uuid=<%= @uuid.sub(".png",".xml") %>',
            type: 'get',
            success: function(data){
                var images = data.images;
                var videos = data.videos;
                var iLen = images.length;
                var vLen = videos.length;
                if(iLen > 0){
                    for(var i= 0;i<iLen;i+=2){
                        if (iLen-i == 1){
                            $('#pictures table').append('<tr><td><a class="pictures" href="'+images[i]+'"><img width="'+iWidth+'px" src="'+images[i]+'" class="video_img"/></a></td><td></td></tr>')
                        }else {
                            $('#pictures table').append('<tr><td><a class="pictures" href="'+images[i]+'"><img width="'+iWidth+'px" src="'+images[i]+'" class="video_img"/></a></td><td><a class="pictures" href="'+images[i+1]+'"><img width="'+iWidth+'px" src="'+images[i+1]+'" class="video_img"/></a></td></tr>')
                        }
                    }
                    $('.pictures').fancybox();
                }

                if(vLen > 0){
                    var k = '',j = '';
                    for(var i= 0;i<vLen;i+=2){
                        if (vLen-i == 1){
                            if(iLen == 0){ k = '/icon/videoStart.png'}else if(i<iLen){ k = images[i]}else{k = images[0]}
                            $('#videos table').append('<tr><td><a href="/health_records/play_video?video_url='+videos[i]+'" target="_blank"><img width="'+iWidth+'px" src="'+k+'" class="video_img" class="video_img"/></a></td><td></td></tr>')
                        }else {
                            if(iLen == 0){ k = '/icon/videoStart.png'}else if(i<iLen){ k = images[i]}else{k = images[0]}
                            if(iLen == 0){ j = '/icon/videoStart.png'}else if((i + 1)<iLen){ j = images[i+1]}else{j = images[0]}
                            $('#videos table').append('<tr><td><a href="/health_records/play_video?video_url='+videos[i]+'" target="_blank"><img width="'+iWidth+'px" src="'+k+'" class="video_img" class="video_img"/></a></td><td><a href="/health_records/play_video?video_url='+videos[i+1]+'" target="_blank"><img width="'+iWidth+'px" src="'+j+'" class="video_img"/></a></td></tr>')
                        }
                    }
                }
            },
            error: function(data){
                console.log(data);
            }
        })
    });
</script>