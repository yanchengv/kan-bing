<%= form_for(@note) do |f| %>

                <% if @note.errors.any? %>
                    <div id="error_explanation">
                      <h2><%= pluralize(@note.errors.count, "error") %> prohibited this note from being saved:</h2>

                      <ul>
                        <% @note.errors.full_messages.each do |msg| %>
                            <li><%= msg %></li>
                        <% end %>
                      </ul>
                    </div>
                <% end %>

                <div class="field" style="margin-bottom:15px;margin-top:15px;">
                  <%= f.label '标题' %>
                  <%= f.text_field :head%>
                </div>
    <div class="field" style="margin-bottom:15px;margin-top:15px;">
      <%= f.label '副标题' %>
      <%= f.text_field :subhead %>
    </div>
    <div class="field" style="margin-bottom:15px;margin-top:15px;">
      <%= f.label '文章类型' %>
      <%= f.select(:archtype, current_user.note_types.collect { |t| [t.name, t.id] }, {:include_blank => false}) %>
    </div>

                <div class="field" style="margin-bottom:15px;">
                  <%= f.kindeditor :content, :window_onload => true , :simple_mode => false ,:options => { uploadJson:"/kindeditor/upload",fileManagerJson:"/kindeditor/filemanager" }%>
                </div>


                <div class="field" style="margin-bottom:15px;">
                  <%= f.check_box :is_allow_comment %>
                  <%= f.label '是否允许评论' %>
                </div>
                <div class="field" style="margin-bottom:15px;">

                  标签 <input type="text" name="tag_name" id="tag_name" value="请用逗号(,)隔开" onclick="clear_tag_text()">
                </div>

                <div class="actions">
                  <%= f.submit '保存文章' %>
                </div>

<% end %>

<script type="text/javascript" charset="utf-8">

    $(document).on("pageload",function(){
        console.log("pageload   editor load ");
        KindEditor.ready(function(K){
            var contentEditor = K.create("textarea[name='content']",{
                height:400,
                width:"100%",
                allowFileManager:true,
                // 文件上传提交路径
                uploadJson:"kindeditor/upload",
                fileManagerJson:"kindeditor/filemanager",
                // 下面这两行最重要了，就是用来同步数据的
                afterCreate: function(){ this.sync(); },
                afterBlur: function(){ this.sync(); }
            });
        });
        if ($('#note_content').length > 0){
          //  KindEditor.create '#article_content', "width":"100%", "height":300, "allowFileManager":true, "uploadJson":"/kindeditor/upload", "fileManagerJson":"/kindeditor/filemanager"
        }
    });
</script>


